# -*- coding: utf-8 -*-
# *** Spyder Python Console History Log ***

## ---(Thu Mar  1 10:35:58 2018)---


## ---(Thu Mar  1 14:11:41 2018)---
runfile('C:/Users/Public/Documents/Python Scripts/地图.py', wdir='C:/Users/Public/Documents/Python Scripts')
runfile('D:/地图.py', wdir='D:')

## ---(Wed Apr 18 13:42:13 2018)---
from pathlib import Path
p = Path(r'd:\欧泊.txt')
p.read_text(encoding='utf-8')
p.read_text()
p = Path(r'd:\欧泊.txt')
wb = xw.Book.caller()
p = Path(r'd:\欧泊.txt')
p.read_text()
p.read_text(encoding='utf-8')

## ---(Wed Apr 18 16:57:45 2018)---
import win32clipboard as wincb
import win32con
wincb.OpenClipboard()
wincb.EmptyClipboard()
p = Path(r'd:\欧泊.html')
from pathlib import Path
p = Path(r'd:\欧泊.html')
p.read_text()
wincb.SetClipboardData(win32con.CF_TEXT, p.read_text())
wincb.GetClipboardData(win32con.CF_TEXT)
wincb.SetClipboardData(win32con.CF_TEXT, p.read_text())
wincb.GetClipboardData(win32con.CF_TEXT)
wincb.CloseClipboard()
wincb.SetClipboardText(win32con.CF_TEXT, p.read_text())
wincb.OpenClipboard()

## ---(Wed Apr 18 22:05:02 2018)---
import win32clipboard as wincb
import win32con

from pathlib import Path

p = Path(r'd:\欧泊.html')

astring = p.read_text()
wincb.OpenClipboard()
wincb.EmptyClipboard()

wincb.SetClipboardText(win32con.CF_TEXT, astring)

wincb.SetClipboardText()
wincb.SetClipboardText() /?
help(wincb.SetClipboardText())
help(wincb.SetClipboardText)
help(wincb.SetClipboardText())
wincb.SetClipboardText(win32con.CF_TEXT, astring)
wincb.SetClipboardText(win32con.CF_TEXT, 1)
wincb.SetClipboardText(win32con.CF_TEXT, astring)
wincb.SetClipboardText(1, astring)
wincb.SetClipboardText(astring)
wincb.CloseClipboard()

wincb.CloseClipboard()

p = Path(r'd:\欧泊.html')
wincb.OpenClipboard()
wincb.EmptyClipboard()
wincb.SetClipboardText(p.read_text())
wincb.CloseClipboard()

import win32clipboard as wincb
from pathlib import Path
import xlwings as xw

def deal_Clipboard():
    p = Path(r'd:\欧泊.html')
    wincb.OpenClipboard()
    wincb.EmptyClipboard()
    wincb.SetClipboardText(p.read_text())
    wincb.CloseClipboard()


def deal_Clipboard():
    p = Path(r'd:\欧泊.html')
    wincb.OpenClipboard()
    wincb.EmptyClipboard()
    wincb.SetClipboardText(p.read_text())
    wincb.CloseClipboard()


def deal_Clipboard():
    p = Path(r'd:\欧泊.html')
    wincb.OpenClipboard()
    wincb.EmptyClipboard()
    wincb.SetClipboardText(p.read_text())
    wincb.CloseClipboard()


deal_Clipboard()

## ---(Thu May 17 19:27:47 2018)---
data = {'hearScorecardInfo': '{"licenseregistereddate":"914403007703484923","franchisebrand":"1000"}'}
data
runfile('C:/Users/S103878/Documents/Python Script/信息协同平台.py', wdir='C:/Users/S103878/Documents/Python Script')
a.text
import json
json.dumps(a.text)
json.loads(a.text)
runfile('C:/Users/S103878/Documents/Python Script/信息协同平台.py', wdir='C:/Users/S103878/Documents/Python Script')
s = inputeEntities: {"search_EQ_suppliername":"深圳市恒金制衣有限公司","search_EQ_suppliershort":"恒金","search_EQ_supplieraddress":"深圳市大鹏新区葵涌街道葵新社区银葵路16号君轩公司厂房C栋三、四楼","search_EQ_workaddress":"深圳市大鹏新区葵涌街道葵新社区银葵路16号君轩公司厂房C栋三、四楼","search_EQ_takinggoods":"深圳市大鹏新区葵涌街道葵新社区银葵路16号君轩公司厂房C栋三、四楼","search_EQ_provinces":"190","search_EQ_city":"深圳","search_EQ_commitmentcapacity":"","search_EQ_factoryname":"深圳市恒金制衣有限公司","search_EQ_productionaddress":"深圳市大鹏新区葵涌街道葵新社区银葵路16号君轩公司厂房C栋三、四楼","search_EQ_suppliertype":"CY","search_EQ_companynature":"99","search_EQ_operationmode":"01","search_EQ_franchisebrand":"1000","search_EQ_legalperson":"张德正","search_EQ_idcard":"0","search_EQ_operator":"","search_EQ_phonenumber":"0755-89775056","search_EQ_registeredcapital":"100万元","search_EQ_registereddate":"2005-01-19","search_EQ_producttypeshoe":"","search_EQ_businesslimit1":"","search_EQ_businesslimit2":"","search_EQ_licenseupdatedate":"2017-04-10","search_EQ_licenseregistereddate":"914403007703484923","search_EQ_organizationcode":"77034849-2","search_EQ_expiredate":"","search_EQ_taxregistrationcode":"440307770348492 ","search_EQ_permissionaccountcode":"","search_EQ_settlementaccount":"4000026419200050002","search_EQ_accountbank":"102584002643 ","search_EQ_banknumber":"102584002643 ","search_EQ_taxno":"","search_EQ_factoryarea":"4860","search_EQ_factoryunit":"01","search_EQ_usingarea":"3500","search_EQ_usingunit":"01","search_EQ_storagearea":"1360","search_EQ_storageunit":"01","search_EQ_employeewages":"5100.00","search_EQ_factorynature":"BC","search_EQ_plantnature":"01","search_EQ_firecertificate":"是","search_EQ_erpsystembrand":"有","search_EQ_softwarebrand":"富怡","search_EQ_other":"","search_EQ_supplieraccountgroup":"Z100","search_EQ_sortl":"甲方自提","search_EQ_insourcingratio":"100%","search_EQ_termspayment":"SM06","search_EQ_remark":"","search_EQ_businesspeople":"18","search_EQ_procurementstaff":"4","search_EQ_designer":"4","search_EQ_iepersonnel":"3","search_EQ_samplemaking":"12","search_EQ_qualitypersonnel":"42","search_EQ_technologypersonnel":"26","search_EQ_productionpersonnel":"646","search_EQ_qualityatio":"7.64%","search_EQ_storekeeper":"4","search_EQ_tidypersonnel":"60","search_EQ_wholestaffratio":"10.91%","search_EQ_laboratorypersonnel":"2","search_EQ_administratorstaff":"40","search_EQ_outsourcestaff":"","search_EQ_pqn":"1200","search_EQ_iqn":"","search_EQ_financenumber":"8","search_EQ_productiongroup":"34","search_EQ_groupnumber":"20","search_EQ_suppliernumber":"550","search_EQ_garmentpatternmaker":"2","search_EQ_garmenttypographers":"1","search_EQ_garmentmi":"3","search_EQ_interfilierem":"","search_EQ_interfilierweaving":"","search_EQ_interfilierdf":"","search_EQ_interfiliermolding":"","search_EQ_interfilierel":"","search_EQ_interfilierpb":"","search_EQ_liningmolding":"","search_EQ_liningelectroplating":"","search_EQ_liningds":"","search_EQ_liningweq":"","search_EQ_liningdfm":"","search_EQ_liningpdery":"","search_EQ_liningptq":"","search_EQ_liningpbq":"","search_EQ_outsourcingcategory":"","search_EQ_outsourcingproduction":"","search_EQ_outsourcing":"","search_EQ_outfactorynumber":"","search_EQ_distributionregion":"","search_EQ_beforeyearproduction":"","search_EQ_lastyearproduction":"500.00","search_EQ_planproduction":"500.00","search_EQ_existingproduction":"200.00","search_EQ_provideproduction":"500.00","search_EQ_providenumber":"400","search_EQ_productssale":"100.00","search_EQ_productionseason":"","search_EQ_productionpeak":"","search_EQ_childrenclothing":"","search_EQ_otherabilities":"","search_EQ_lastyear1":"2016年","search_EQ_yeartotalassets":"1431.00","search_EQ_financialunit1":"万元","search_EQ_debt1":"735.00","search_EQ_debtratio1":"51.36%","search_EQ_lastmonth":"2017年2月","search_EQ_monthtotalassets":"1773.00","search_EQ_financialunit2":"万元","search_EQ_debt2":"1068.00","search_EQ_debtratio2":"60.24%","search_EQ_lastyear2":"2016年","search_EQ_annualsalesamount":"7344.00","search_EQ_financialunit3":"万元","search_EQ_liquidity":"1366.00","search_EQ_financialunit4":"万元","search_EQ_profitslastyear":"661539.00","search_EQ_totalloans":"0","search_EQ_repaymenthistory":"否","search_EQ_guarantee":"否","search_EQ_guaranteeamount":"","search_EQ_companysecuredname":"","search_EQ_contactInfoName":"","search_EQ_contactInfoTel":"","search_EQ_contactInfoPhone":"","search_EQ_contactInfoQQ":"","search_EQ_contactInfoEmail":"","search_EQ_amb":"男T卫衣(新),女T卫衣(新)","search_EQ_producttype":"针织","licenseregistereddateold":"914403007703484923","franchisebrandold":"1000","lifnr":"0001100001"}
contactInfoDatagrid: [{"no":1,"position":"董事长","name":"张德正(老板)","tel":"13923772593","phone":"0755-89775036","qq":"0755-89775016","email":""},{"no":2,"position":"<font color='#FF000C'>总经理(必输)</font>","name":"","tel":"","phone":"","qq":"","email":""},{"no":3,"position":"<font color='#FF000C'>业务经理(必输)</font>","name":"","tel":"","phone":"","qq":"","email":""},{"no":4,"position":"<font color='#FF000C'>业务员(必输)</font>","name":"张晓莉","tel":"0755-61822781","phone":"18923823935","qq":"18923823935","email":"3022036342@QQ.COM"},{"no":5,"position":"生产经理","name":"王晓","tel":"0755-61822781","phone":"0755-61822781","qq":"","email":""},{"no":6,"position":"品控经理","name":"","tel":"","phone":"","qq":"","email":""},{"no":7,"position":"财务经理","name":"","tel":"","phone":"","qq":"","email":""},{"no":8,"position":"<font color='#FF000C'>资料填报人(必输)</font>","name":"","tel":"","phone":"","qq":"","email":""},]
operatingInfoDatagrid: [{"no":1,"country":"中国","cusname":"森马","cooperationbrand":"森马","annualsales":"500万件","symmetry1":"100%","region":"","supname":"","annualpurchase":"","symmetry2":""},]
categoryCapacityInfoDatagrid: [{"no":1,"category":"针织卫衣","quantity":"15万件","symmetry":"30%","averageprocessingfee":"20","salesprice":"60"},{"no":2,"category":"针织裤","quantity":"10万件","symmetry":"20%","averageprocessingfee":"14","salesprice":"45"},{"no":3,"category":"针织T恤","quantity":"25万件","symmetry":"50%","averageprocessingfee":"5","salesprice":"30"},]
fileInfoDatagrid: [{"no":1,"filetype":"营业执照","begindate":"","enddate":"","filename":"恒金_新营业执照（2017）.pdf","filesize":"1.44MB","licenseregistereddate":"914403007703484923","franchisebrand":"1000","fileKey":"7fb7c5f7-8efb-4d94-9bbf-b9acda228a79","filePath":"file:/d:/appServer/nginx-1.4.1-dev/html/file/file_upload_AnonymityRegister/7fb7c5f7-8efb-4d94-9bbf-b9acda228a79.pdf","fileUpLoadTime":"2017-11-07 09:48:38","fileStatus":"上传成功"},{"no":2,"filetype":"开户许可证","begindate":"","enddate":"","filename":"","filesize":"","licenseregistereddate":"914403007703484923","franchisebrand":"1000","fileKey":"","filePath":"","fileUpLoadTime":"","fileStatus":""},{"no":3,"filetype":"盖章版开票资料","begindate":"","enddate":"","filename":"","filesize":"","licenseregistereddate":"914403007703484923","franchisebrand":"1000","fileKey":"","filePath":"","fileUpLoadTime":"","fileStatus":""},{"no":4,"filetype":"设备清单","begindate":"","enddate":"","filename":"","filesize":"","licenseregistereddate":"914403007703484923","franchisebrand":"1000","fileKey":"","filePath":"","fileUpLoadTime":"","fileStatus":""},{"no":5,"filetype":"消防合格证","begindate":"","enddate":"","filename":"","filesize":"","licenseregistereddate":"914403007703484923","franchisebrand":"1000","fileKey":"","filePath":"","fileUpLoadTime":"","fileStatus":""},{"no":6,"filetype":"公司组织架构图","begindate":"","enddate":"","filename":"","filesize":"","licenseregistereddate":"914403007703484923","franchisebrand":"1000","fileKey":"","filePath":"","fileUpLoadTime":"","fileStatus":""},{"no":7,"filetype":"业务流程图","begindate":"","enddate":"","filename":"","filesize":"","licenseregistereddate":"914403007703484923","franchisebrand":"1000","fileKey":"","filePath":"","fileUpLoadTime":"","fileStatus":""},{"no":8,"filetype":"品控架构流程图","begindate":"","enddate":"","filename":"","filesize":"","licenseregistereddate":"914403007703484923","franchisebrand":"1000","fileKey":"","filePath":"","fileUpLoadTime":"","fileStatus":""},{"no":9,"filetype":"一般纳税人证明","begindate":"","enddate":"","filename":"","filesize":"","licenseregistereddate":"914403007703484923","franchisebrand":"1000","fileKey":"","filePath":"","fileUpLoadTime":"","fileStatus":""},]
hearScorecardInfo: {"licenseregistereddate":"914403007703484923","franchisebrand":"1000","lifnr":"0001100001"}

s = inputeEntities: {"search_EQ_suppliername":"深圳市恒金制衣有限公司","search_EQ_suppliershort":"恒金","search_EQ_supplieraddress":"深圳市大鹏新区葵涌街道葵新社区银葵路16号君轩公司厂房C栋三、四楼","search_EQ_workaddress":"深圳市大鹏新区葵涌街道葵新社区银葵路16号君轩公司厂房C栋三、四楼","search_EQ_takinggoods":"深圳市大鹏新区葵涌街道葵新社区银葵路16号君轩公司厂房C栋三、四楼","search_EQ_provinces":"190","search_EQ_city":"深圳","search_EQ_commitmentcapacity":"","search_EQ_factoryname":"深圳市恒金制衣有限公司","search_EQ_productionaddress":"深圳市大鹏新区葵涌街道葵新社区银葵路16号君轩公司厂房C栋三、四楼","search_EQ_suppliertype":"CY","search_EQ_companynature":"99","search_EQ_operationmode":"01","search_EQ_franchisebrand":"1000","search_EQ_legalperson":"张德正","search_EQ_idcard":"0","search_EQ_operator":"","search_EQ_phonenumber":"0755-89775056","search_EQ_registeredcapital":"100万元","search_EQ_registereddate":"2005-01-19","search_EQ_producttypeshoe":"","search_EQ_businesslimit1":"","search_EQ_businesslimit2":"","search_EQ_licenseupdatedate":"2017-04-10","search_EQ_licenseregistereddate":"914403007703484923","search_EQ_organizationcode":"77034849-2","search_EQ_expiredate":"","search_EQ_taxregistrationcode":"440307770348492 ","search_EQ_permissionaccountcode":"","search_EQ_settlementaccount":"4000026419200050002","search_EQ_accountbank":"102584002643 ","search_EQ_banknumber":"102584002643 ","search_EQ_taxno":"","search_EQ_factoryarea":"4860","search_EQ_factoryunit":"01","search_EQ_usingarea":"3500","search_EQ_usingunit":"01","search_EQ_storagearea":"1360","search_EQ_storageunit":"01","search_EQ_employeewages":"5100.00","search_EQ_factorynature":"BC","search_EQ_plantnature":"01","search_EQ_firecertificate":"是","search_EQ_erpsystembrand":"有","search_EQ_softwarebrand":"富怡","search_EQ_other":"","search_EQ_supplieraccountgroup":"Z100","search_EQ_sortl":"甲方自提","search_EQ_insourcingratio":"100%","search_EQ_termspayment":"SM06","search_EQ_remark":"","search_EQ_businesspeople":"18","search_EQ_procurementstaff":"4","search_EQ_designer":"4","search_EQ_iepersonnel":"3","search_EQ_samplemaking":"12","search_EQ_qualitypersonnel":"42","search_EQ_technologypersonnel":"26","search_EQ_productionpersonnel":"646","search_EQ_qualityatio":"7.64%","search_EQ_storekeeper":"4","search_EQ_tidypersonnel":"60","search_EQ_wholestaffratio":"10.91%","search_EQ_laboratorypersonnel":"2","search_EQ_administratorstaff":"40","search_EQ_outsourcestaff":"","search_EQ_pqn":"1200","search_EQ_iqn":"","search_EQ_financenumber":"8","search_EQ_productiongroup":"34","search_EQ_groupnumber":"20","search_EQ_suppliernumber":"550","search_EQ_garmentpatternmaker":"2","search_EQ_garmenttypographers":"1","search_EQ_garmentmi":"3","search_EQ_interfilierem":"","search_EQ_interfilierweaving":"","search_EQ_interfilierdf":"","search_EQ_interfiliermolding":"","search_EQ_interfilierel":"","search_EQ_interfilierpb":"","search_EQ_liningmolding":"","search_EQ_liningelectroplating":"","search_EQ_liningds":"","search_EQ_liningweq":"","search_EQ_liningdfm":"","search_EQ_liningpdery":"","search_EQ_liningptq":"","search_EQ_liningpbq":"","search_EQ_outsourcingcategory":"","search_EQ_outsourcingproduction":"","search_EQ_outsourcing":"","search_EQ_outfactorynumber":"","search_EQ_distributionregion":"","search_EQ_beforeyearproduction":"","search_EQ_lastyearproduction":"500.00","search_EQ_planproduction":"500.00","search_EQ_existingproduction":"200.00","search_EQ_provideproduction":"500.00","search_EQ_providenumber":"400","search_EQ_productssale":"100.00","search_EQ_productionseason":"","search_EQ_productionpeak":"","search_EQ_childrenclothing":"","search_EQ_otherabilities":"","search_EQ_lastyear1":"2016年","search_EQ_yeartotalassets":"1431.00","search_EQ_financialunit1":"万元","search_EQ_debt1":"735.00","search_EQ_debtratio1":"51.36%","search_EQ_lastmonth":"2017年2月","search_EQ_monthtotalassets":"1773.00","search_EQ_financialunit2":"万元","search_EQ_debt2":"1068.00","search_EQ_debtratio2":"60.24%","search_EQ_lastyear2":"2016年","search_EQ_annualsalesamount":"7344.00","search_EQ_financialunit3":"万元","search_EQ_liquidity":"1366.00","search_EQ_financialunit4":"万元","search_EQ_profitslastyear":"661539.00","search_EQ_totalloans":"0","search_EQ_repaymenthistory":"否","search_EQ_guarantee":"否","search_EQ_guaranteeamount":"","search_EQ_companysecuredname":"","search_EQ_contactInfoName":"","search_EQ_contactInfoTel":"","search_EQ_contactInfoPhone":"","search_EQ_contactInfoQQ":"","search_EQ_contactInfoEmail":"","search_EQ_amb":"男T卫衣(新),女T卫衣(新)","search_EQ_producttype":"针织","licenseregistereddateold":"914403007703484923","franchisebrandold":"1000","lifnr":"0001100001"}contactInfoDatagrid: [{"no":1,"position":"董事长","name":"张德正(老板)","tel":"13923772593","phone":"0755-89775036","qq":"0755-89775016","email":""},{"no":2,"position":"<font color='#FF000C'>总经理(必输)</font>","name":"","tel":"","phone":"","qq":"","email":""},{"no":3,"position":"<font color='#FF000C'>业务经理(必输)</font>","name":"","tel":"","phone":"","qq":"","email":""},{"no":4,"position":"<font color='#FF000C'>业务员(必输)</font>","name":"张晓莉","tel":"0755-61822781","phone":"18923823935","qq":"18923823935","email":"3022036342@QQ.COM"},{"no":5,"position":"生产经理","name":"王晓","tel":"0755-61822781","phone":"0755-61822781","qq":"","email":""},{"no":6,"position":"品控经理","name":"","tel":"","phone":"","qq":"","email":""},{"no":7,"position":"财务经理","name":"","tel":"","phone":"","qq":"","email":""},{"no":8,"position":"<font color='#FF000C'>资料填报人(必输)</font>","name":"","tel":"","phone":"","qq":"","email":""},]
operatingInfoDatagrid: [{"no":1,"country":"中国","cusname":"森马","cooperationbrand":"森马","annualsales":"500万件","symmetry1":"100%","region":"","supname":"","annualpurchase":"","symmetry2":""},]
categoryCapacityInfoDatagrid: [{"no":1,"category":"针织卫衣","quantity":"15万件","symmetry":"30%","averageprocessingfee":"20","salesprice":"60"},{"no":2,"category":"针织裤","quantity":"10万件","symmetry":"20%","averageprocessingfee":"14","salesprice":"45"},{"no":3,"category":"针织T恤","quantity":"25万件","symmetry":"50%","averageprocessingfee":"5","salesprice":"30"},]
fileInfoDatagrid: [{"no":1,"filetype":"营业执照","begindate":"","enddate":"","filename":"恒金_新营业执照（2017）.pdf","filesize":"1.44MB","licenseregistereddate":"914403007703484923","franchisebrand":"1000","fileKey":"7fb7c5f7-8efb-4d94-9bbf-b9acda228a79","filePath":"file:/d:/appServer/nginx-1.4.1-dev/html/file/file_upload_AnonymityRegister/7fb7c5f7-8efb-4d94-9bbf-b9acda228a79.pdf","fileUpLoadTime":"2017-11-07 09:48:38","fileStatus":"上传成功"},{"no":2,"filetype":"开户许可证","begindate":"","enddate":"","filename":"","filesize":"","licenseregistereddate":"914403007703484923","franchisebrand":"1000","fileKey":"","filePath":"","fileUpLoadTime":"","fileStatus":""},{"no":3,"filetype":"盖章版开票资料","begindate":"","enddate":"","filename":"","filesize":"","licenseregistereddate":"914403007703484923","franchisebrand":"1000","fileKey":"","filePath":"","fileUpLoadTime":"","fileStatus":""},{"no":4,"filetype":"设备清单","begindate":"","enddate":"","filename":"","filesize":"","licenseregistereddate":"914403007703484923","franchisebrand":"1000","fileKey":"","filePath":"","fileUpLoadTime":"","fileStatus":""},{"no":5,"filetype":"消防合格证","begindate":"","enddate":"","filename":"","filesize":"","licenseregistereddate":"914403007703484923","franchisebrand":"1000","fileKey":"","filePath":"","fileUpLoadTime":"","fileStatus":""},{"no":6,"filetype":"公司组织架构图","begindate":"","enddate":"","filename":"","filesize":"","licenseregistereddate":"914403007703484923","franchisebrand":"1000","fileKey":"","filePath":"","fileUpLoadTime":"","fileStatus":""},{"no":7,"filetype":"业务流程图","begindate":"","enddate":"","filename":"","filesize":"","licenseregistereddate":"914403007703484923","franchisebrand":"1000","fileKey":"","filePath":"","fileUpLoadTime":"","fileStatus":""},{"no":8,"filetype":"品控架构流程图","begindate":"","enddate":"","filename":"","filesize":"","licenseregistereddate":"914403007703484923","franchisebrand":"1000","fileKey":"","filePath":"","fileUpLoadTime":"","fileStatus":""},{"no":9,"filetype":"一般纳税人证明","begindate":"","enddate":"","filename":"","filesize":"","licenseregistereddate":"914403007703484923","franchisebrand":"1000","fileKey":"","filePath":"","fileUpLoadTime":"","fileStatus":""},]
hearScorecardInfo: {"licenseregistereddate":"914403007703484923","franchisebrand":"1000","lifnr":"0001100001"}
inputeEntities:= {"search_EQ_suppliername":"深圳市恒金制衣有限公司","search_EQ_suppliershort":"恒金","search_EQ_supplieraddress":"深圳市大鹏新区葵涌街道葵新社区银葵路16号君轩公司厂房C栋三、四楼","search_EQ_workaddress":"深圳市大鹏新区葵涌街道葵新社区银葵路16号君轩公司厂房C栋三、四楼","search_EQ_takinggoods":"深圳市大鹏新区葵涌街道葵新社区银葵路16号君轩公司厂房C栋三、四楼","search_EQ_provinces":"190","search_EQ_city":"深圳","search_EQ_commitmentcapacity":"","search_EQ_factoryname":"深圳市恒金制衣有限公司","search_EQ_productionaddress":"深圳市大鹏新区葵涌街道葵新社区银葵路16号君轩公司厂房C栋三、四楼","search_EQ_suppliertype":"CY","search_EQ_companynature":"99","search_EQ_operationmode":"01","search_EQ_franchisebrand":"1000","search_EQ_legalperson":"张德正","search_EQ_idcard":"0","search_EQ_operator":"","search_EQ_phonenumber":"0755-89775056","search_EQ_registeredcapital":"100万元","search_EQ_registereddate":"2005-01-19","search_EQ_producttypeshoe":"","search_EQ_businesslimit1":"","search_EQ_businesslimit2":"","search_EQ_licenseupdatedate":"2017-04-10","search_EQ_licenseregistereddate":"914403007703484923","search_EQ_organizationcode":"77034849-2","search_EQ_expiredate":"","search_EQ_taxregistrationcode":"440307770348492 ","search_EQ_permissionaccountcode":"","search_EQ_settlementaccount":"4000026419200050002","search_EQ_accountbank":"102584002643 ","search_EQ_banknumber":"102584002643 ","search_EQ_taxno":"","search_EQ_factoryarea":"4860","search_EQ_factoryunit":"01","search_EQ_usingarea":"3500","search_EQ_usingunit":"01","search_EQ_storagearea":"1360","search_EQ_storageunit":"01","search_EQ_employeewages":"5100.00","search_EQ_factorynature":"BC","search_EQ_plantnature":"01","search_EQ_firecertificate":"是","search_EQ_erpsystembrand":"有","search_EQ_softwarebrand":"富怡","search_EQ_other":"","search_EQ_supplieraccountgroup":"Z100","search_EQ_sortl":"甲方自提","search_EQ_insourcingratio":"100%","search_EQ_termspayment":"SM06","search_EQ_remark":"","search_EQ_businesspeople":"18","search_EQ_procurementstaff":"4","search_EQ_designer":"4","search_EQ_iepersonnel":"3","search_EQ_samplemaking":"12","search_EQ_qualitypersonnel":"42","search_EQ_technologypersonnel":"26","search_EQ_productionpersonnel":"646","search_EQ_qualityatio":"7.64%","search_EQ_storekeeper":"4","search_EQ_tidypersonnel":"60","search_EQ_wholestaffratio":"10.91%","search_EQ_laboratorypersonnel":"2","search_EQ_administratorstaff":"40","search_EQ_outsourcestaff":"","search_EQ_pqn":"1200","search_EQ_iqn":"","search_EQ_financenumber":"8","search_EQ_productiongroup":"34","search_EQ_groupnumber":"20","search_EQ_suppliernumber":"550","search_EQ_garmentpatternmaker":"2","search_EQ_garmenttypographers":"1","search_EQ_garmentmi":"3","search_EQ_interfilierem":"","search_EQ_interfilierweaving":"","search_EQ_interfilierdf":"","search_EQ_interfiliermolding":"","search_EQ_interfilierel":"","search_EQ_interfilierpb":"","search_EQ_liningmolding":"","search_EQ_liningelectroplating":"","search_EQ_liningds":"","search_EQ_liningweq":"","search_EQ_liningdfm":"","search_EQ_liningpdery":"","search_EQ_liningptq":"","search_EQ_liningpbq":"","search_EQ_outsourcingcategory":"","search_EQ_outsourcingproduction":"","search_EQ_outsourcing":"","search_EQ_outfactorynumber":"","search_EQ_distributionregion":"","search_EQ_beforeyearproduction":"","search_EQ_lastyearproduction":"500.00","search_EQ_planproduction":"500.00","search_EQ_existingproduction":"200.00","search_EQ_provideproduction":"500.00","search_EQ_providenumber":"400","search_EQ_productssale":"100.00","search_EQ_productionseason":"","search_EQ_productionpeak":"","search_EQ_childrenclothing":"","search_EQ_otherabilities":"","search_EQ_lastyear1":"2016年","search_EQ_yeartotalassets":"1431.00","search_EQ_financialunit1":"万元","search_EQ_debt1":"735.00","search_EQ_debtratio1":"51.36%","search_EQ_lastmonth":"2017年2月","search_EQ_monthtotalassets":"1773.00","search_EQ_financialunit2":"万元","search_EQ_debt2":"1068.00","search_EQ_debtratio2":"60.24%","search_EQ_lastyear2":"2016年","search_EQ_annualsalesamount":"7344.00","search_EQ_financialunit3":"万元","search_EQ_liquidity":"1366.00","search_EQ_financialunit4":"万元","search_EQ_profitslastyear":"661539.00","search_EQ_totalloans":"0","search_EQ_repaymenthistory":"否","search_EQ_guarantee":"否","search_EQ_guaranteeamount":"","search_EQ_companysecuredname":"","search_EQ_contactInfoName":"","search_EQ_contactInfoTel":"","search_EQ_contactInfoPhone":"","search_EQ_contactInfoQQ":"","search_EQ_contactInfoEmail":"","search_EQ_amb":"男T卫衣(新),女T卫衣(新)","search_EQ_producttype":"针织","licenseregistereddateold":"914403007703484923","franchisebrandold":"1000","lifnr":"0001100001"}
json.loads('''{"search_EQ_suppliername":"深圳市恒金制衣有限公司","search_EQ_suppliershort":"恒金","search_EQ_supplieraddress":"深圳市大鹏新区葵涌街道葵新社区银葵路16号君轩公司厂房C栋三、四楼","search_EQ_workaddress":"深圳市大鹏新区葵涌街道葵新社区银葵路16号君轩公司厂房C栋三、四楼","search_EQ_takinggoods":"深圳市大鹏新区葵涌街道葵新社区银葵路16号君轩公司厂房C栋三、四楼","search_EQ_provinces":"190","search_EQ_city":"深圳","search_EQ_commitmentcapacity":"","search_EQ_factoryname":"深圳市恒金制衣有限公司","search_EQ_productionaddress":"深圳市大鹏新区葵涌街道葵新社区银葵路16号君轩公司厂房C栋三、四楼","search_EQ_suppliertype":"CY","search_EQ_companynature":"99","search_EQ_operationmode":"01","search_EQ_franchisebrand":"1000","search_EQ_legalperson":"张德正","search_EQ_idcard":"0","search_EQ_operator":"","search_EQ_phonenumber":"0755-89775056","search_EQ_registeredcapital":"100万元","search_EQ_registereddate":"2005-01-19","search_EQ_producttypeshoe":"","search_EQ_businesslimit1":"","search_EQ_businesslimit2":"","search_EQ_licenseupdatedate":"2017-04-10","search_EQ_licenseregistereddate":"914403007703484923","search_EQ_organizationcode":"77034849-2","search_EQ_expiredate":"","search_EQ_taxregistrationcode":"440307770348492 ","search_EQ_permissionaccountcode":"","search_EQ_settlementaccount":"4000026419200050002","search_EQ_accountbank":"102584002643 ","search_EQ_banknumber":"102584002643 ","search_EQ_taxno":"","search_EQ_factoryarea":"4860","search_EQ_factoryunit":"01","search_EQ_usingarea":"3500","search_EQ_usingunit":"01","search_EQ_storagearea":"1360","search_EQ_storageunit":"01","search_EQ_employeewages":"5100.00","search_EQ_factorynature":"BC","search_EQ_plantnature":"01","search_EQ_firecertificate":"是","search_EQ_erpsystembrand":"有","search_EQ_softwarebrand":"富怡","search_EQ_other":"","search_EQ_supplieraccountgroup":"Z100","search_EQ_sortl":"甲方自提","search_EQ_insourcingratio":"100%","search_EQ_termspayment":"SM06","search_EQ_remark":"","search_EQ_businesspeople":"18","search_EQ_procurementstaff":"4","search_EQ_designer":"4","search_EQ_iepersonnel":"3","search_EQ_samplemaking":"12","search_EQ_qualitypersonnel":"42","search_EQ_technologypersonnel":"26","search_EQ_productionpersonnel":"646","search_EQ_qualityatio":"7.64%","search_EQ_storekeeper":"4","search_EQ_tidypersonnel":"60","search_EQ_wholestaffratio":"10.91%","search_EQ_laboratorypersonnel":"2","search_EQ_administratorstaff":"40","search_EQ_outsourcestaff":"","search_EQ_pqn":"1200","search_EQ_iqn":"","search_EQ_financenumber":"8","search_EQ_productiongroup":"34","search_EQ_groupnumber":"20","search_EQ_suppliernumber":"550","search_EQ_garmentpatternmaker":"2","search_EQ_garmenttypographers":"1","search_EQ_garmentmi":"3","search_EQ_interfilierem":"","search_EQ_interfilierweaving":"","search_EQ_interfilierdf":"","search_EQ_interfiliermolding":"","search_EQ_interfilierel":"","search_EQ_interfilierpb":"","search_EQ_liningmolding":"","search_EQ_liningelectroplating":"","search_EQ_liningds":"","search_EQ_liningweq":"","search_EQ_liningdfm":"","search_EQ_liningpdery":"","search_EQ_liningptq":"","search_EQ_liningpbq":"","search_EQ_outsourcingcategory":"","search_EQ_outsourcingproduction":"","search_EQ_outsourcing":"","search_EQ_outfactorynumber":"","search_EQ_distributionregion":"","search_EQ_beforeyearproduction":"","search_EQ_lastyearproduction":"500.00","search_EQ_planproduction":"500.00","search_EQ_existingproduction":"200.00","search_EQ_provideproduction":"500.00","search_EQ_providenumber":"400","search_EQ_productssale":"100.00","search_EQ_productionseason":"","search_EQ_productionpeak":"","search_EQ_childrenclothing":"","search_EQ_otherabilities":"","search_EQ_lastyear1":"2016年","search_EQ_yeartotalassets":"1431.00","search_EQ_financialunit1":"万元","search_EQ_debt1":"735.00","search_EQ_debtratio1":"51.36%","search_EQ_lastmonth":"2017年2月","search_EQ_monthtotalassets":"1773.00","search_EQ_financialunit2":"万元","search_EQ_debt2":"1068.00","search_EQ_debtratio2":"60.24%","search_EQ_lastyear2":"2016年","search_EQ_annualsalesamount":"7344.00","search_EQ_financialunit3":"万元","search_EQ_liquidity":"1366.00","search_EQ_financialunit4":"万元","search_EQ_profitslastyear":"661539.00","search_EQ_totalloans":"0","search_EQ_repaymenthistory":"否","search_EQ_guarantee":"否","search_EQ_guaranteeamount":"","search_EQ_companysecuredname":"","search_EQ_contactInfoName":"","search_EQ_contactInfoTel":"","search_EQ_contactInfoPhone":"","search_EQ_contactInfoQQ":"","search_EQ_contactInfoEmail":"","search_EQ_amb":"男T卫衣(新),女T卫衣(新)","search_EQ_producttype":"针织","licenseregistereddateold":"914403007703484923","franchisebrandold":"1000","lifnr":"0001100001"}''')
contactInfoDatagrid:=[{"no":1,"position":"董事长","name":"张德正(老板)","tel":"13923772593","phone":"0755-89775036","qq":"0755-89775016","email":""},{"no":2,"position":"<font color='#FF000C'>总经理(必输)</font>","name":"","tel":"","phone":"","qq":"","email":""},{"no":3,"position":"<font color='#FF000C'>业务经理(必输)</font>","name":"","tel":"","phone":"","qq":"","email":""},{"no":4,"position":"<font color='#FF000C'>业务员(必输)</font>","name":"张晓莉","tel":"0755-61822781","phone":"18923823935","qq":"18923823935","email":"3022036342@QQ.COM"},{"no":5,"position":"生产经理","name":"王晓","tel":"0755-61822781","phone":"0755-61822781","qq":"","email":""},{"no":6,"position":"品控经理","name":"","tel":"","phone":"","qq":"","email":""},{"no":7,"position":"财务经理","name":"","tel":"","phone":"","qq":"","email":""},{"no":8,"position":"<font color='#FF000C'>资料填报人(必输)</font>","name":"","tel":"","phone":"","qq":"","email":""},]
contactInfoDatagrid =[{"no":1,"position":"董事长","name":"张德正(老板)","tel":"13923772593","phone":"0755-89775036","qq":"0755-89775016","email":""},{"no":2,"position":"<font color='#FF000C'>总经理(必输)</font>","name":"","tel":"","phone":"","qq":"","email":""},{"no":3,"position":"<font color='#FF000C'>业务经理(必输)</font>","name":"","tel":"","phone":"","qq":"","email":""},{"no":4,"position":"<font color='#FF000C'>业务员(必输)</font>","name":"张晓莉","tel":"0755-61822781","phone":"18923823935","qq":"18923823935","email":"3022036342@QQ.COM"},{"no":5,"position":"生产经理","name":"王晓","tel":"0755-61822781","phone":"0755-61822781","qq":"","email":""},{"no":6,"position":"品控经理","name":"","tel":"","phone":"","qq":"","email":""},{"no":7,"position":"财务经理","name":"","tel":"","phone":"","qq":"","email":""},{"no":8,"position":"<font color='#FF000C'>资料填报人(必输)</font>","name":"","tel":"","phone":"","qq":"","email":""}]
operatingInfoDatagrid = [{"no":1,"country":"中国","cusname":"森马","cooperationbrand":"森马","annualsales":"500万件","symmetry1":"100%","region":"","supname":"","annualpurchase":"","symmetry2":""},]
categoryCapacityInfoDatagrid = [{"no":1,"category":"针织卫衣","quantity":"15万件","symmetry":"30%","averageprocessingfee":"20","salesprice":"60"},{"no":2,"category":"针织裤","quantity":"10万件","symmetry":"20%","averageprocessingfee":"14","salesprice":"45"},{"no":3,"category":"针织T恤","quantity":"25万件","symmetry":"50%","averageprocessingfee":"5","salesprice":"30"},]
fileInfoDatagrid = [{"no":1,"filetype":"营业执照","begindate":"","enddate":"","filename":"恒金_新营业执照（2017）.pdf","filesize":"1.44MB","licenseregistereddate":"914403007703484923","franchisebrand":"1000","fileKey":"7fb7c5f7-8efb-4d94-9bbf-b9acda228a79","filePath":"file:/d:/appServer/nginx-1.4.1-dev/html/file/file_upload_AnonymityRegister/7fb7c5f7-8efb-4d94-9bbf-b9acda228a79.pdf","fileUpLoadTime":"2017-11-07 09:48:38","fileStatus":"上传成功"},{"no":2,"filetype":"开户许可证","begindate":"","enddate":"","filename":"","filesize":"","licenseregistereddate":"914403007703484923","franchisebrand":"1000","fileKey":"","filePath":"","fileUpLoadTime":"","fileStatus":""},{"no":3,"filetype":"盖章版开票资料","begindate":"","enddate":"","filename":"","filesize":"","licenseregistereddate":"914403007703484923","franchisebrand":"1000","fileKey":"","filePath":"","fileUpLoadTime":"","fileStatus":""},{"no":4,"filetype":"设备清单","begindate":"","enddate":"","filename":"","filesize":"","licenseregistereddate":"914403007703484923","franchisebrand":"1000","fileKey":"","filePath":"","fileUpLoadTime":"","fileStatus":""},{"no":5,"filetype":"消防合格证","begindate":"","enddate":"","filename":"","filesize":"","licenseregistereddate":"914403007703484923","franchisebrand":"1000","fileKey":"","filePath":"","fileUpLoadTime":"","fileStatus":""},{"no":6,"filetype":"公司组织架构图","begindate":"","enddate":"","filename":"","filesize":"","licenseregistereddate":"914403007703484923","franchisebrand":"1000","fileKey":"","filePath":"","fileUpLoadTime":"","fileStatus":""},{"no":7,"filetype":"业务流程图","begindate":"","enddate":"","filename":"","filesize":"","licenseregistereddate":"914403007703484923","franchisebrand":"1000","fileKey":"","filePath":"","fileUpLoadTime":"","fileStatus":""},{"no":8,"filetype":"品控架构流程图","begindate":"","enddate":"","filename":"","filesize":"","licenseregistereddate":"914403007703484923","franchisebrand":"1000","fileKey":"","filePath":"","fileUpLoadTime":"","fileStatus":""},{"no":9,"filetype":"一般纳税人证明","begindate":"","enddate":"","filename":"","filesize":"","licenseregistereddate":"914403007703484923","franchisebrand":"1000","fileKey":"","filePath":"","fileUpLoadTime":"","fileStatus":""},]
hearScorecardInfo = {"licenseregistereddate":"914403007703484923","franchisebrand":"1000","lifnr":"0001100001"}
hearScorecardInfo
contactInfoDatagrid
debugfile('C:/Users/S103878/Documents/Python Script/信息协同平台.py', wdir='C:/Users/S103878/Documents/Python Script')
runfile('C:/Users/S103878/Documents/Python Script/信息协同平台.py', wdir='C:/Users/S103878/Documents/Python Script')
json.loads(a.text)
json.loads(a.text)['rows']
json.loads(a.text)['rows'][0]
json.loads(a.text)['rows'][0]['licenseregistereddate']
runfile('C:/Users/S103878/Documents/Python Script/信息协同平台.py', wdir='C:/Users/S103878/Documents/Python Script')
json.loads(a.text)['rows'][0]['licenseregistereddate']
runfile('C:/Users/S103878/Documents/Python Script/信息协同平台.py', wdir='C:/Users/S103878/Documents/Python Script')
json.loads(a.text)['rows'][0]['licenseregistereddate']
runfile('C:/Users/S103878/Documents/Python Script/信息协同平台.py', wdir='C:/Users/S103878/Documents/Python Script')
json.loads(b.text)
json.loads(b.text).keys
json.loads(b.text).keys()
runfile('C:/Users/S103878/Documents/Python Script/信息协同平台.py', wdir='C:/Users/S103878/Documents/Python Script')
json.loads(b.text)
import pandas as pd
pd.DataFrame(json.loads(b.text))
type(json.loads(b.text))
json.loads(b.text)[0]
json.loads(b.text).keys()
json.loads(b.text)['operation']
json.loads(b.text)['deptstaff']

## ---(Fri May 18 10:17:30 2018)---
runfile('C:/Users/S103878/Documents/Python Script/信息协同平台.py', wdir='C:/Users/S103878/Documents/Python Script')
json.loads(b.text)

## ---(Wed May 30 23:21:09 2018)---
runfile('C:/Users/S103878/Documents/Python Script/compare_company.py', wdir='C:/Users/S103878/Documents/Python Script')
runfile('C:/Users/S103878/Documents/Python Script/company.py', wdir='C:/Users/S103878/Documents/Python Script')

## ---(Thu May 31 00:18:45 2018)---
runfile('C:/Users/S103878/Documents/Python Script/company.py', wdir='C:/Users/S103878/Documents/Python Script')
json_location
json_location.keys()
json_location['data']
json_location['data'].keys()
json_location['data']['result']
json_location['data']
json_location['data'].keys()
json_location['data'][0]
json_location['data']['code']
json_location['data']['message']
json_location['data']['is_general_search']
json_location['data']['poi_list']
json_location['data']['poi_list'][0]
json_location['data']['poi_list'][0]['name]
json_location['data']['poi_list'][0]['name']
json_location['data']['poi_list'][0]['longitude']
json_location['data']['poi_list'][0]['latitude']
runfile('C:/Users/S103878/Documents/Python Script/company.py', wdir='C:/Users/S103878/Documents/Python Script')
all_longt_lat
runfile('C:/Users/S103878/Documents/Python Script/company.py', wdir='C:/Users/S103878/Documents/Python Script')
all_longt_lat
runfile('C:/Users/S103878/Documents/Python Script/company.py', wdir='C:/Users/S103878/Documents/Python Script')
city
city[0]
runfile('C:/Users/S103878/Documents/Python Script/company.py', wdir='C:/Users/S103878/Documents/Python Script')
longtitude
str(float(latitude+0.5))
str(float(latitude)+0.05)
runfile('C:/Users/S103878/Documents/Python Script/company.py', wdir='C:/Users/S103878/Documents/Python Script')
for one_city in all_city_info:
    print(one_city))
for one_city in all_city_info:
    print(one_city)
    
for one_city in all_city_info:
    print(one_city['adcode'])
    
all_city_info
for one_city in all_city_info:
    print(one_city['adcode'])
    
for one_city in all_city_info:
    print(all_city_info[one_city]['adcode'])
    
runfile('C:/Users/S103878/Documents/Python Script/company.py', wdir='C:/Users/S103878/Documents/Python Script')
with open('d:\\city_lglat.txt', 'w', encoding='utf-8') as f:
    f.write(str(all_longt_lat))


runfile('C:/Users/S103878/Documents/Python Script/company.py', wdir='C:/Users/S103878/Documents/Python Script')
for i in json_location['data']['poi_list']:
    name = i['name']
    longtitude = i['longitude']
    latitude = i['latitude']
    all_longt_lat.append([name, longtitude, latitude])

print(len(all_longt_lat), all_longt_lat)

for i in json_location['data']['poi_list']:
    name = i['name']
    longtitude = i['longitude']
    latitude = i['latitude']
    all_longt_lat.append([name, longtitude, latitude])

print(len(all_longt_lat), all_longt_lat)

json_location['data']['poi_list']
json_location['data']
json_location = get_one_location(words, querys, adcode)

json_location
runfile('C:/Users/S103878/Documents/Python Script/company.py', wdir='C:/Users/S103878/Documents/Python Script')
json_location = get_one_location(words, querys, adcode)

runfile('C:/Users/S103878/Documents/Python Script/company.py', wdir='C:/Users/S103878/Documents/Python Script')
headers = [  
       {'User-Agent': 'Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:34.0) Gecko/20100101 Firefox/34.0'},  
       {'User-Agent': 'Mozilla/5.0 (Windows; U; Windows NT 6.1; en-US; rv:1.9.1.6) Gecko/20091201 Firefox/3.5.6'},  
       {'User-Agent': 'Mozilla/5.0 (Windows NT 6.2) AppleWebKit/535.11 (KHTML, like Gecko) Chrome/17.0.963.12 Safari/535.11'},  
       {'User-Agent': 'Mozilla/5.0 (compatible; MSIE 10.0; Windows NT 6.2; Trident/6.0)'},  
       {'User-Agent': 'Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:40.0) Gecko/20100101 Firefox/40.0'},  
       {'User-Agent': 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Ubuntu Chromium/44.0.2403.89 Chrome/44.0.2403.89 Safari/537.36'}
       ] 

import random 
random.randrange(headers)
random.randrange(0,7,1)
runfile('C:/Users/S103878/Documents/Python Script/get_ip.py', wdir='C:/Users/S103878/Documents/Python Script')
with open('d:\\HTTPS.txt', 'r', encoding='utf-8') as f:
    file = f.read()
    print(file)
    
with open('d:\\HTTPS.txt', 'r', encoding='utf-8') as f
    file = f.read()
    lst_file = file.split('\n')
with open('d:\\HTTPS.txt', 'r', encoding='utf-8') as f:
    file = f.read()
    lst_file = file.split('\n')
lst_file

len(lst_file)
runfile('C:/Users/S103878/Documents/Python Script/company.py', wdir='C:/Users/S103878/Documents/Python Script')
runfile('C:/Users/S103878/Documents/Python Script/test_ip.py', wdir='C:/Users/S103878/Documents/Python Script')
res = requests.get(r'https://www.baidu.com/', headers=headers, proxies=proxies, timeout=5)
import requests

with open('d:\\HTTPS.txt', 'r', encoding='utf-8') as f:
    file = f.read()
    lst_file = file.split('\n')


proxy = random.choice(lst_file)
proxies = {
    'http': 'http://' + proxy,
    'https': 'https://' + proxy,
    }

import random 

proxy = random.choice(lst_file)
proxies = {
    'http': 'http://' + proxy,
    'https': 'https://' + proxy,
    }

res = requests.get(r'https://www.baidu.com/', headers=headers, proxies=proxies, timeout=5)

lst_headers = [  
    {'User-Agent': 'Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:34.0) Gecko/20100101 Firefox/34.0'},  
    {'User-Agent': 'Mozilla/5.0 (Windows; U; Windows NT 6.1; en-US; rv:1.9.1.6) Gecko/20091201 Firefox/3.5.6'},  
    {'User-Agent': 'Mozilla/5.0 (Windows NT 6.2) AppleWebKit/535.11 (KHTML, like Gecko) Chrome/17.0.963.12 Safari/535.11'},  
    {'User-Agent': 'Mozilla/5.0 (compatible; MSIE 10.0; Windows NT 6.2; Trident/6.0)'},  
    {'User-Agent': 'Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:40.0) Gecko/20100101 Firefox/40.0'},  
    {'User-Agent': 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Ubuntu Chromium/44.0.2403.89 Chrome/44.0.2403.89 Safari/537.36'}
    ] 

headers = random.choice(lst_headers)

res = requests.get(r'https://www.baidu.com/', headers=headers, proxies=proxies, timeout=5)

runfile('C:/Users/S103878/Documents/Python Script/test_ip.py', wdir='C:/Users/S103878/Documents/Python Script')
res.ok
res.raise_for_status
res.raise_for_status()
res.status_code
runfile('C:/Users/S103878/Documents/Python Script/test_ip.py', wdir='C:/Users/S103878/Documents/Python Script')

## ---(Thu May 31 12:15:58 2018)---
runfile('C:/Users/S103878/Documents/Python Script/test_ip.py', wdir='C:/Users/S103878/Documents/Python Script')
runfile('C:/Users/S103878/Documents/Python Script/company.py', wdir='C:/Users/S103878/Documents/Python Script')

## ---(Thu May 31 20:41:54 2018)---
runfile('C:/Users/S103878/Documents/Python Script/get_pay_ip.py', wdir='C:/Users/S103878/Documents/Python Script')
runfile('C:/Users/S103878/Documents/Python Script/test_ip.py', wdir='C:/Users/S103878/Documents/Python Script')
headers = lst_headers[1]

headers
lst_headers[1]
lst_headers = [  
    {'User-Agent': 'Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:34.0) Gecko/20100101 Firefox/34.0'},  
    {'User-Agent': 'Mozilla/5.0 (Windows; U; Windows NT 6.1; en-US; rv:1.9.1.6) Gecko/20091201 Firefox/3.5.6', 'Connection': 'close'},  
    {'User-Agent': 'Mozilla/5.0 (Windows NT 6.2) AppleWebKit/535.11 (KHTML, like Gecko) Chrome/17.0.963.12 Safari/535.11'},  
    {'User-Agent': 'Mozilla/5.0 (compatible; MSIE 10.0; Windows NT 6.2; Trident/6.0)'},  
    {'User-Agent': 'Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:40.0) Gecko/20100101 Firefox/40.0'},  
    {'User-Agent': 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Ubuntu Chromium/44.0.2403.89 Chrome/44.0.2403.89 Safari/537.36'}
    ] 

lst_headers[1]
runfile('C:/Users/S103878/Documents/Python Script/test_ip.py', wdir='C:/Users/S103878/Documents/Python Script')

## ---(Thu May 31 22:48:44 2018)---
runfile('C:/Users/S103878/Documents/Python Script/test_ip.py', wdir='C:/Users/S103878/Documents/Python Script')

## ---(Thu May 31 22:51:02 2018)---
runfile('C:/Users/S103878/Documents/Python Script/test_ip.py', wdir='C:/Users/S103878/Documents/Python Script')
runfile('C:/Users/S103878/Documents/Python Script/company.py', wdir='C:/Users/S103878/Documents/Python Script')
runfile('C:/Users/S103878/Documents/Python Script/company.py', wdir='C:/Users/S103878/Documents/Python Script')
import json
import requests
import pandas as pd
import random 

df = pd.read_csv(r"C:\Users\S103878\Downloads\AMap_adcode_citycode.xlsx\AMap_adcode_citycode.csv", index_col='中文名', encoding='gbk', dtype='str')
all_city_info = df.transpose().to_dict()

all_city_info
df = pd.read_csv(r"C:\Users\S103878\Downloads\AMap_adcode_citycode.xlsx\AMap_adcode_citycode.csv", index_col='中文名', encoding='gbk', dtype='str')
all_city_info = df.transpose().to_dict()

all_city_info
runfile('C:/Users/S103878/Documents/Python Script/company.py', wdir='C:/Users/S103878/Documents/Python Script')

## ---(Fri Jun  1 08:15:59 2018)---
runfile('C:/Users/S103878/Documents/Python Script/company.py', wdir='C:/Users/S103878/Documents/Python Script')
json_location
json_location['data']['poi_list']
json_location['data'].keys()
json_location['data']['poi_list'].keys()
json_location['data']['poi_list'][0]
runfile('C:/Users/S103878/Documents/Python Script/test_ip.py', wdir='C:/Users/S103878/Documents/Python Script')
runfile('C:/Users/S103878/Documents/Python Script/get_pay_ip.py', wdir='C:/Users/S103878/Documents/Python Script')
runfile('C:/Users/S103878/Documents/Python Script/test_ip.py', wdir='C:/Users/S103878/Documents/Python Script')
runfile('C:/Users/S103878/Documents/Python Script/test_ip.py', wdir='C:/Users/S103878/Documents/Python Script')
with open('d:\\HTTPS.txt', 'r', encoding='utf-8') as f:
    file = f.read()
    lst_file = file.strip(' ').split('\n')
    
runfile('C:/Users/S103878/Documents/Python Script/test_ip.py', wdir='C:/Users/S103878/Documents/Python Script')
res.encoding
res.encoding = 'gbk'
res.text
res.encoding = 'utf-8'
res.text
res.connection
res.connection()
res.connection.close
res.connection.close()

res.connection.max_retries
res.connection.max_retries()
res.connection.max_retries(5)
res.connection.proxy_headers
res.connection.proxy_headers()
res.connection.config
res.close()
runfile('C:/Users/S103878/Documents/Python Script/test_ip.py', wdir='C:/Users/S103878/Documents/Python Script')
res.status_code == 200
res.status_code == '200'
res.status_code
res.status_code == '503'
res.status_code == 503
runfile('C:/Users/S103878/Documents/Python Script/test_ip.py', wdir='C:/Users/S103878/Documents/Python Script')
help(requests.get())
help(requests.get)
help(requests.get())
requests.get() /?
requests.get() ??
requests.get()
dict(requests.get())

## ---(Wed Jun  6 18:09:15 2018)---
runfile('C:/Users/S103878/Desktop/核价单汇总(2).py', wdir='C:/Users/S103878/Desktop')
model
getEmbody()
material()
df
x = r"D:\文档\IE科\13019050208.xlsx"
xb = app.books.open(x)

app = xw.App(visible=False, add_book=False)
app.display_alerts = False
app.screen_updating = True

xb = app.books.open(x)

print(xb.name, '正在写入……')

need_sheet = [i for i in xb.sheets if i.api.visible==-1]

i = need_sheet[0]
df = fun_df(i)

df
title = GetData(i)

title.extend(getEmbody())

multi_color.append(title)

multi_color
print(xb.name, '已经写入\n')

xb.close()

all_value.extend(multi_color)

all_value
runfile('C:/Users/S103878/Desktop/核价单汇总(2).py', wdir='C:/Users/S103878/Desktop')
x = r"D:\文档\IE科\13019050208.xlsx"
xb = app.books.open(x)

app = xw.App(visible=False, add_book=False)
app.display_alerts = False
app.screen_updating = True

xb = app.books.open(x)
need_sheet = [i for i in xb.sheets if i.api.visible==-1]

i = need_sheet[0]
for i in need_sheet:
    df = fun_df(i)
    title = GetData(i)
    title.extend(getEmbody())
    multi_color.append(title)


runfile('C:/Users/S103878/Desktop/核价单汇总(2).py', wdir='C:/Users/S103878/Desktop')
app = xw.App(visible=False, add_book=False)
app.display_alerts = False
app.screen_updating = True

x = r"D:\文档\IE科\13019050208.xlsx"
xb = app.books.open(x)
print(xb.name, '正在写入……')
need_sheet = [i for i in xb.sheets if i.api.visible==-1]
for i in need_sheet:
    if i.range('c7') != '':
        df = fun_df(i)
        title = GetData(i)
        title.extend(getEmbody())
        multi_color.append(title)
    else:
        pass

print(xb.name, '已经写入\n')
xb.close()
all_value.extend(multi_color)

need_sheet = [i for i in xb.sheets if i.api.visible==-1]

need_sheet
need_sheet = [i for i in xb.sheets if i.api.visible==-1 and i.range('c7') != '']

need_sheet
o = need_sheet[1]
need_sheet = [i for i in xb.sheets if i.api.visible==-1 and i.range('c7').value != '']

need_sheet
o = need_sheet[1].range('c7').value
0
need_sheet[1].range('c7').value
need_sheet[1].range('c7').value == 0
need_sheet[1].range('c7').value == ''
need_sheet[1].range('c7').value
need_sheet[1].range('c7').value is None
need_sheet[1].range('c7').value is not None
runfile('C:/Users/S103878/Desktop/核价单汇总(2).py', wdir='C:/Users/S103878/Desktop')

## ---(Sat Jul  7 11:50:38 2018)---
runfile('C:/Users/S103878/Pictures/Tmall.py', wdir='C:/Users/S103878/Pictures')
get_products()
runfile('C:/Users/S103878/Pictures/Tmall.py', wdir='C:/Users/S103878/Pictures')
get_products
ipd
def get_products(self,page):
    '''提取单页商品列表'''
    num = random.randint(83739921, 87739530)
    endurl = '/shop/shop_auction_search.do?sort=s&p={}&page_size=12&from=h5&ajson=1&_tm_source=tmallsearch&callback=jsonp_{}'
    url = self.url + endurl.format(page,num)
    html = requests.get(url, headers=self.headers).text
    infos = re.findall('\(({.*})\)', html)[0]
    infos = json.loads(infos)
    products = infos.get('items')
    title = ['item_id', 'price', 'quantity', 'sold', 'title', 'totalSoldQuantity', 'url', 'img']
    with open(self.filename, 'a', newline='') as f:
        writer = csv.DictWriter(f, fieldnames=title)
        writer.writerows(products)


get_products(1)
get_products(2)
get_products(1)
TM_producs.get_products(1)
TM_producs.get_products(self,1)
TM_producs.get_products()
runfile('C:/Users/S103878/Pictures/Tmall.py', wdir='C:/Users/S103878/Pictures')
TM_producs.get_file()
TM_producs.get_totalpage
TM_producs.get_totalpage()
s = TM_producs.get_totalpage()
TM_producs.get_totalpage(1)
TM_producs.get_totalpage()
TM_producs.get_totalpage(self)
s = TM_producs
s.get_products()
runfile('C:/Users/S103878/Pictures/Tmall.py', wdir='C:/Users/S103878/Pictures')
TM_producs
TM_producs.get_file()
TM_producs.url
s = TM_producs('优衣库')
s.filename
s.get_file
s.get_file()
s.get_products()
s.get_products(1)
s.get_totalpage()
runfile('C:/Users/S103878/Pictures/Tmall.py', wdir='C:/Users/S103878/Pictures')
s.get_totalpage()
runfile('C:/Users/S103878/Pictures/Tmall.py', wdir='C:/Users/S103878/Pictures')
s = TM_producs('优衣库')
s.get_totalpage()
s = TM_producs('uniqlo')
s.get_totalpage()
s.get_products(1)
runfile('C:/Users/S103878/Pictures/Tmall.py', wdir='C:/Users/S103878/Pictures')
s = TM_producs('uniqlo')
s.get_products(1)

## ---(Sat Jul  7 17:45:22 2018)---
runfile('C:/Users/S103878/Pictures/Tmall.py', wdir='C:/Users/S103878/Pictures')
storename = 'uniqlo'
tm = TM_producs(storename)
tm.get_totalpage()
tm.get_products()
tm.get_products(1)
runfile('C:/Users/S103878/Pictures/Tmall.py', wdir='C:/Users/S103878/Pictures')
storename = 'uniqlo'
tm = TM_producs(storename)
tm.get_products(1)
runfile('C:/Users/S103878/Pictures/Tmall.py', wdir='C:/Users/S103878/Pictures')
import csv

csv.DictReader(r"C:\Users\S103878\Pictures\uniqlo_201807071815.csv", encoding='utf-8')
csv.DictReader(r"C:\Users\S103878\Pictures\uniqlo_201807071815.csv")
l = csv.DictReader(r"C:\Users\S103878\Pictures\uniqlo_201807071815.csv")
l.reader
l.reader()
l.fieldnames
l = csv.DictReader(r"C:\Users\S103878\Pictures\uniqlo_201807071815.csv", fieldnames=title)
title = ['item_id','price','quantity','sold','title','titleUnderIconList', 'totalSoldQuantity','url','img']
l = csv.DictReader(r"C:\Users\S103878\Pictures\uniqlo_201807071815.csv", fieldnames=title)
l
l.restval
l.restval()
l.restkey
l.restkey()
l[0]
l.line_num
for i in L
for i in l:
    print(i)
    
l = csv.DictReader(r"C:\Users\S103878\Pictures\uniqlo_201807071815.csv")
for i in l:
    print(i)
    
with open(r"C:\Users\S103878\Pictures\uniqlo_201807071815.csv", newline='') as csvfile:
...     reader = csv.DictReader(csvfile)
...     for row in reader:
...         print(row['first_name'], row['last_name'])
        
with open(r"C:\Users\S103878\Pictures\uniqlo_201807071815.csv", newline='') as csvfile:
...     reader = csv.DictReader(csvfile)
...     for row in reader:
...         print(row)
        
with open(r"C:\Users\S103878\Pictures\uniqlo_201807071815.csv", newline='') as csvfile:
...     reader = csv.DictReader(csvfile)
...     for row in reader:
...         print(row['url'])
        
runfile('C:/Users/S103878/Pictures/Tmall_detail.py', wdir='C:/Users/S103878/Pictures')
json_data = self.set_resquests(url)

pathfile = r"C:\Users\S103878\Pictures\uniqlo_201807071815.csv"

tm = Producs_detail(pathfile)

tm.get_file()
tm.get_url(pathfile)
for i in tm.get_url(pathfile):
    print(i)
    
url = r'https://detail.m.tmall.com/item.htm?id=573188926280'
json_data = self.set_resquests(url)

tm.set_resquests(url)
json_data = tm.set_resquests(url)
tm.basic_info(json_data)
tm.get_monsellcounts(json_data)
runfile('C:/Users/S103878/Pictures/Tmall_detail.py', wdir='C:/Users/S103878/Pictures')
tm.get_monsellcounts(json_data)
json_data = self.set_resquests(url)
url = r'https://detail.m.tmall.com/item.htm?id=573188926280'
json_data = tm.set_resquests(url)
tm.get_monsellcounts(json_data)
sell_counts = json.loads(json_data['data']['apiStack'][0]['value'])
sell_img = 'https'+sell_counts['skuBase']['props'][0]['values'][0]['image']
sellCount = sell_counts['item']['sellCount']

try:
    sell_img = sell_counts['item']['videos'][0]['videoThumbnailURL']
except IndexError as e:
    sell_img = 'https'+sell_counts['skuBase']['props'][0]['values'][0]['image']


json_data = tm.set_resquests(url)
tm.get_monsellcounts(json_data)
try:
    sell_img = sell_counts['item']['videos'][0]['videoThumbnailURL']
except IndexError as e:
    print(e)

else:
    sell_img = 'https'+sell_counts['skuBase']['props'][0]['values'][0]['image']

try:
    sell_img = sell_counts['item']['videos'][0]['videoThumbnailURL']
except IndexError as e:
    print('this picture is not there')

else:
    sell_img = 'https'+sell_counts['skuBase']['props'][0]['values'][0]['image']

sell_img
runfile('C:/Users/S103878/Pictures/Tmall_detail.py', wdir='C:/Users/S103878/Pictures')
tm = Producs_detail(pathfile)
url
tm.get_monsellcounts()
json_data = tm.set_resquests(url)
tm.get_monsellcounts(json_data)
def get_monsellcounts(self, json_data):
    item_basic = json_data['data']['item']
    commentCount = item_basic['commentCount']
    subtitle = item_basic['subtitle']
    return commentCount, subtitle


tm.get_monsellcounts(json_data)
item_basic
item_basic = json_data['data']['item']

commentCount = item_basic['commentCount']

subtitle = item_basic['subtitle']

subtitle
tm.basic_info(json_data)
tm.get_sell_price()
tm.get_sell_price(json_data)
tm.get_time_count(json_data)
runfile('C:/Users/S103878/Pictures/Tmall_detail.py', wdir='C:/Users/S103878/Pictures')
json_data = tm.set_resquests(url)
tm.get_monsellcounts(json_data)
item_basic = json_data['data']['item']

commentCount = item_basic['commentCount']

subtitle = item_basic['subtitle']

subtitle
runfile('C:/Users/S103878/Pictures/Tmall_detail.py', wdir='C:/Users/S103878/Pictures')
json_data = tm.set_resquests(url)
tm.get_monsellcounts(json_data)
runfile('C:/Users/S103878/Pictures/Tmall_detail.py', wdir='C:/Users/S103878/Pictures')
url = r'https://detail.m.tmall.com/item.htm?id=573188926280'
pathfile = r"C:\Users\S103878\Pictures\uniqlo_201807071815.csv"
tm = Producs_detail(pathfile)
runfile('C:/Users/S103878/Pictures/Tmall_detail.py', wdir='C:/Users/S103878/Pictures')
tm = Producs_detail(pathfile)
json_data = tm.set_resquests(url)
tm.get_monsellcounts(json_data)
tm.get_sell_price(json_data)
tm.get_time_count()
tm.get_time_count(json_data)
tm.basic_info(json_data)
runfile('C:/Users/S103878/Pictures/Tmall_detail.py', wdir='C:/Users/S103878/Pictures')
{'a':1, 'b':2, 'c':3}
f = {'a':1, 'b':2, 'c':3}
f.get('a')
import csv
runfile('C:/Users/S103878/Pictures/Tmall_detail.py', wdir='C:/Users/S103878/Pictures')

## ---(Tue Jul 10 18:13:29 2018)---
runfile('C:/Users/Public/Documents/Python Scripts/Lianjia_spider.py', wdir='C:/Users/Public/Documents/Python Scripts')

## ---(Mon Jul 23 18:59:30 2018)---
runfile('C:/Users/Public/Documents/Python Scripts/clothe.py', wdir='C:/Users/Public/Documents/Python Scripts')